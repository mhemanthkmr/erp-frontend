import{aA as _,aB as $,a as l,an as b,am as e,aC as F,aG as M}from"./index-NNRCG9Rm.js";import{V as R,O as c,a5 as W,ae as Y,a4 as q,a8 as g,a7 as f,a6 as r,ac as U}from"./IdurarOs-hOF3usfi.js";import"./index-vCtOLfRs.js";import{c as G,s as H,E as I}from"./selectors-ODi0nExu.js";import{P as Q}from"./index-nierwHcH.js";import{e as w}from"./actions-NDaFrLo5.js";import{s as d}from"./index-xrkCjAY0.js";import{u as v}from"./useDate-Fz8rfIL3.js";import{u as V}from"./useMail-hc4anCKM.js";import{t as z}from"./statusTagColor-sG5xH6CK.js";import{T as J}from"./index-ntKD6FMB.js";import{S as h}from"./index-lIOrhGAA.js";import{D as j}from"./index-bUsKcndE.js";import{C as K}from"./CloseCircleOutlined-agQ2nFs_.js";import{F as X}from"./FilePdfOutlined-4twY-BbQ.js";import{R as Z}from"./RetweetOutlined-VAcYpuHi.js";import"./ErpApp-og-vdlRX.js";import"./currency.es--or6eeOG.js";const ee=({item:a})=>{const{moneyFormatter:i}=v();return e.jsxs(g,{gutter:[12,0],children:[e.jsxs(r,{className:"gutter-row",span:11,children:[e.jsx("p",{style:{marginBottom:5},children:e.jsx("strong",{children:a.itemName})}),e.jsx("p",{children:a.description})]}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:i({amount:a.price})})}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:a.quantity})}),e.jsx(r,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right",fontWeight:"700"},children:i({amount:a.total})})}),e.jsx(f,{dashed:!0,style:{marginTop:0,marginBottom:15}})]},a._id)};function te({config:a,selectedItem:i}){var C;const s=R(),{entity:n,ENTITY_NAME:y}=a,u=_(),{moneyFormatter:o}=v(),{send:O,isLoading:S}=V({entity:n}),T=$(),[N,D]=l.useState({}),{result:x}=b(G),P={status:"",lead:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[k,A]=l.useState([]),[t,E]=l.useState(i??P);return l.useEffect(()=>{const m=new AbortController;if(x){const{items:L,invoice:p,...B}=x;L?(A(L),E(x)):p.items&&(A(p.items),E({...p.items,...B,...p}))}return()=>m.abort()},[x]),l.useEffect(()=>{t!=null&&t.lead&&D(t.lead[t.lead.type])},[t]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{onBack:()=>{T(`/${n.toLowerCase()}`)},title:`${y} # ${t.number}/${t.year||""}`,ghost:!1,tags:e.jsx(J,{color:(C=z(t.status))==null?void 0:C.color,children:s(t.status)}),extra:[e.jsx(c,{onClick:()=>{T(`/${n.toLowerCase()}`)},icon:e.jsx(K,{}),children:s("Close")},`${d.generate()}`),e.jsx(c,{onClick:()=>{window.open(`${W}${n}/${n}-${t._id}.pdf`,"_blank")},icon:e.jsx(X,{}),children:s("Download PDF")},`${d.generate()}`),e.jsx(c,{loading:S,onClick:()=>{O(t._id)},icon:e.jsx(Y,{}),children:s("Send by email")},`${d.generate()}`),e.jsx(c,{onClick:()=>{u(w.convert({entity:n,id:t._id}))},icon:e.jsx(Z,{}),style:{display:n==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${d.generate()}`),e.jsx(c,{onClick:()=>{u(w.currentAction({actionType:"update",data:t})),T(`/${n.toLowerCase()}/update/${t._id}`)},type:"primary",icon:e.jsx(q,{}),children:s("Edit")},`${d.generate()}`)],style:{padding:"20px 0px"},children:e.jsxs(g,{children:[e.jsx(h,{title:"Status",value:t.status}),e.jsx(h,{title:s("SubTotal"),value:o({amount:t.subTotal}),style:{margin:"0 32px"}}),e.jsx(h,{title:s("Total"),value:o({amount:t.total}),style:{margin:"0 32px"}}),e.jsx(h,{title:s("Balance"),value:o({amount:t.credit}),style:{margin:"0 32px"}})]})}),e.jsx(f,{dashed:!0}),e.jsxs(j,{title:`lead : ${t.lead.name}`,children:[e.jsx(j.Item,{label:s("Address"),children:N.address}),e.jsx(j.Item,{label:s("email"),children:N.email}),e.jsx(j.Item,{label:s("Phone"),children:N.phone})]}),e.jsx(f,{}),e.jsxs(g,{gutter:[12,0],children:[e.jsx(r,{className:"gutter-row",span:11,children:e.jsx("p",{children:e.jsx("strong",{children:s("product")})})}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("PRICE")})})}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("QUANTITY")})})}),e.jsx(r,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("TOTAL")})})}),e.jsx(f,{})]}),k.map(m=>e.jsx(ee,{item:m},m._id)),e.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:e.jsxs(g,{gutter:[12,-5],children:[e.jsx(r,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Sub Total")," : "]})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsx("p",{children:o({amount:t.subTotal})})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsxs("p",{children:["Tax Total (",t.taxRate," %) :"]})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsx("p",{children:o({amount:t.taxTotal})})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total")," :"]})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsx("p",{children:o({amount:t.total})})})]})})]})}function se({config:a}){const i=_(),{id:s}=F();$(),l.useLayoutEffect(()=>{i(w.read({entity:a.entity,id:s}))},[s]);const{result:n,isSuccess:y,isLoading:u=!0}=b(H);return u?e.jsx(I,{children:e.jsx(M,{})}):e.jsx(I,{children:y?e.jsx(te,{config:a,selectedItem:n}):e.jsx(U,{entity:a.entity})})}function Ne(){const a=R(),i="offer",s={PANEL_TITLE:a("offer"),DATATABLE_TITLE:a("offer_list"),ADD_NEW_ENTITY:a("add_new_offer"),ENTITY_NAME:a("offer")},n={entity:i,...s};return e.jsx(se,{config:n})}export{Ne as default};
