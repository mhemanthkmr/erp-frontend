import{aA as O,aB as k,a as c,an as D,am as t}from"./index-NNRCG9Rm.js";import{P as E}from"./index-nierwHcH.js";import{V as b,a9 as j,O as L,a7 as A,ad as B}from"./IdurarOs-hOF3usfi.js";import{d as I}from"./ErpApp-og-vdlRX.js";import{e as T}from"./actions-NDaFrLo5.js";import{g as N}from"./selectors-ODi0nExu.js";import{c as r}from"./calculate-xJ0-_hck.js";import{s as S}from"./index-xrkCjAY0.js";import{T as H}from"./index-ntKD6FMB.js";import{C as R}from"./CloseCircleOutlined-agQ2nFs_.js";import{P as _}from"./PlusOutlined-RgQQQ1Jv.js";function z({form:l}){const u=b(),o=()=>{l.submit()};return t.jsx(L,{onClick:o,type:"primary",icon:t.jsx(_,{}),children:u("Save")})}function tt({config:l,CreateForm:u}){const o=b(),f=O(),m=k();c.useEffect(()=>{f(I.list({entity:"setting"}))},[]);let{entity:n}=l;const{isLoading:v,isSuccess:h,result:F}=D(N),[p]=j.useForm(),[P,y]=c.useState(0),[$,C]=c.useState(0),q=(a,i)=>{const s=i.items;let d=0,g=0;s&&(s.map(e=>{if(e){if(e.offerPrice&&e.quantity){let x=r.multiply(e.quantity,e.offerPrice);g=r.add(g,x)}if(e.quantity&&e.price){let x=r.multiply(e.quantity,e.price);d=r.add(d,x)}}}),y(d),C(g))};c.useEffect(()=>(h&&(p.resetFields(),f(T.resetAction({actionType:"create"})),y(0),C(0),m(`/${n.toLowerCase()}/read/${F._id}`)),()=>{}),[h]);const w=a=>{if(a&&a.items){let i=[...a.items];i.map(s=>{s.total=r.multiply(s.quantity,s.price)}),a={...a,items:i}}f(T.create({entity:n,jsonData:a}))};return t.jsxs(t.Fragment,{children:[t.jsx(E,{onBack:()=>{m(`/${n.toLowerCase()}`)},title:o("New"),ghost:!1,tags:t.jsx(H,{children:o("Draft")}),extra:[t.jsx(L,{onClick:()=>m(`/${n.toLowerCase()}`),icon:t.jsx(R,{}),children:o("Cancel")},`${S.generate()}`),t.jsx(z,{form:p},`${S.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(A,{dashed:!0}),t.jsx(B,{isLoading:v,children:t.jsx(j,{form:p,layout:"vertical",onFinish:w,onValuesChange:q,children:t.jsx(u,{subTotal:P,offerTotal:$})})})]})}export{tt as C};
