import{a as m,h as S,an as _,am as e,aB as $,aA as w}from"./index-NNRCG9Rm.js";import{P}from"./index-nierwHcH.js";import{A as M,V as B,a3 as N,a4 as F,O as v,a5 as z}from"./IdurarOs-hOF3usfi.js";import{e as i}from"./actions-NDaFrLo5.js";import{e as W,f as H}from"./selectors-ODi0nExu.js";import{a as A}from"./index-vCtOLfRs.js";import{s as T}from"./index-xrkCjAY0.js";import{D as K,E as U}from"./ErpApp-og-vdlRX.js";import{T as V}from"./Table-yESaXSHN.js";import{F as Y}from"./FilePdfOutlined-4twY-BbQ.js";import{D as q}from"./DeleteOutlined-XARtgMJL.js";import{P as G}from"./PlusOutlined-RgQQQ1Jv.js";import{a as J}from"./helpers-rPTOY0Yj.js";import{M as Q}from"./index-ESSCVN9R.js";var X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};const Z=X;var ee=function(o,a){return m.createElement(M,S({},o,{ref:a,icon:Z}))};const te=m.forwardRef(ee);function ae({config:n}){const o=$(),{ADD_NEW_ENTITY:a,entity:s}=n,l=()=>{o(`/${s.toLowerCase()}/create`)};return e.jsx(v,{onClick:l,type:"primary",icon:e.jsx(G,{}),children:a})}function se({config:n,extra:o=[]}){const a=B();let{entity:s,dataTableColumns:l,disableAdd:d=!1}=n;const{DATATABLE_TITLE:c}=n,{result:h,isLoading:g}=_(W),{pagination:y,items:b}=h,{erpContextAction:j}=A(),{modal:f}=j,D=[{label:a("Show"),key:"read",icon:e.jsx(N,{})},{label:a("Edit"),key:"edit",icon:e.jsx(F,{})},{label:a("Download"),key:"download",icon:e.jsx(Y,{})},...o,{type:"divider"},{label:a("Delete"),key:"delete",icon:e.jsx(q,{})}],x=$(),E=t=>{u(i.currentItem({data:t})),x(`/${s}/read/${t._id}`)},k=t=>{const r={...t};u(i.currentAction({actionType:"update",data:r})),x(`/${s}/update/${t._id}`)},p=t=>{window.open(`${z}${s}/${s}-${t._id}.pdf`,"_blank")},O=t=>{u(i.currentAction({actionType:"delete",data:t})),f.open()},R=t=>{u(i.currentItem({data:t})),x(`/invoice/pay/${t._id}`)};l=[...l,{title:"",key:"action",fixed:"right",render:(t,r)=>e.jsx(K,{menu:{items:D,onClick:({key:C})=>{switch(C){case"read":E(r);break;case"edit":k(r);break;case"download":p(r);break;case"delete":O(r);break;case"recordPayment":R(r);break}}},trigger:["click"],children:e.jsx(U,{style:{cursor:"pointer",fontSize:"24px"},onClick:C=>C.preventDefault()})})}];const u=w(),L=t=>{const r={page:t.current||1,items:t.pageSize||10};u(i.list({entity:s,options:r}))},I=()=>{u(i.list({entity:s}))};return m.useEffect(()=>{const t=new AbortController;return I(),()=>{t.abort()}},[]),e.jsxs(e.Fragment,{children:[e.jsx(P,{title:c,ghost:!0,extra:[e.jsx(v,{onClick:L,icon:e.jsx(te,{}),children:a("Refresh")},`${T.generate()}`),!d&&e.jsx(ae,{config:n},`${T.generate()}`)],style:{padding:"20px 0px"}}),e.jsx(V,{columns:l,rowKey:t=>t._id,dataSource:b,pagination:y,loading:g,onChange:L,scroll:{x:!0}})]})}function ne({config:n}){let{entity:o,deleteModalLabels:a,deleteMessage:s="Do you want delete : ",modalTitle:l="Remove Item"}=n;const d=w(),{current:c,isLoading:h,isSuccess:g}=_(H),{state:y,erpContextAction:b}=A(),{deleteModal:j}=y,{modal:f}=b,[D,x]=m.useState("");m.useEffect(()=>{if(g){f.close();const p={page:1,items:10};d(i.list({entity:o,options:p}))}if(c){let p=a.map(O=>J(c,O)).join(" ");x(p)}},[g,c]);const E=()=>{const p=c._id;d(i.delete({entity:o,id:p})),f.close(),d(i.list({entity:o}))},k=()=>{h||f.close()};return e.jsx(Q,{title:l,open:j.isOpen,onOk:E,onCancel:k,confirmLoading:h,children:e.jsxs("p",{children:[s,D]})})}function be({config:n,extra:o}){const a=w(),{state:s}=A(),{deleteModal:l}=s,d=()=>{a(i.resetState())};return m.useLayoutEffect(()=>{const c=new AbortController;return d(),()=>{c.abort()}},[]),e.jsxs(e.Fragment,{children:[e.jsx(se,{config:n,extra:o}),e.jsx(ne,{config:n,isOpen:l.isOpen})]})}export{be as E};
