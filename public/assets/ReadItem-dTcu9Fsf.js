import{aA as O,aB as P,an as B,a as o,am as t}from"./index-NNRCG9Rm.js";import{P as F}from"./index-nierwHcH.js";import{V as M,O as c,a5 as W,ae as q,a4 as H,a8 as j,a7 as g,a6 as a}from"./IdurarOs-hOF3usfi.js";import{e as b}from"./actions-NDaFrLo5.js";import{s as d}from"./index-xrkCjAY0.js";import{c as Q}from"./selectors-ODi0nExu.js";import{u as E}from"./useDate-Fz8rfIL3.js";import{u as U}from"./useMail-hc4anCKM.js";import{t as A}from"./statusTagColor-sG5xH6CK.js";import{T as v}from"./index-ntKD6FMB.js";import{R as V}from"./RetweetOutlined-VAcYpuHi.js";import{S as p}from"./index-lIOrhGAA.js";import{D as h}from"./index-bUsKcndE.js";import{C as Y}from"./CloseCircleOutlined-agQ2nFs_.js";import{F as z}from"./FilePdfOutlined-4twY-BbQ.js";const G=({item:r})=>{const{moneyFormatter:m}=E();return t.jsxs(j,{gutter:[12,0],children:[t.jsxs(a,{className:"gutter-row",span:11,children:[t.jsx("p",{style:{marginBottom:5},children:t.jsx("strong",{children:r.itemName})}),t.jsx("p",{children:r.description})]}),t.jsx(a,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:m({amount:r.price})})}),t.jsx(a,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:r.quantity})}),t.jsx(a,{className:"gutter-row",span:5,children:t.jsx("p",{style:{textAlign:"right",fontWeight:"700"},children:m({amount:r.total})})}),t.jsx(g,{dashed:!0,style:{marginTop:0,marginBottom:15}})]},r._id)};function mt({config:r,selectedItem:m}){var $,S;const s=M(),{entity:n,ENTITY_NAME:I}=r,N=O(),y=P(),{moneyFormatter:i}=E(),{send:R,isLoading:_}=U({entity:n}),{result:x}=B(Q),T={status:"",client:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[k,f]=o.useState([]),[e,w]=o.useState(m??T),[C,D]=o.useState({});return o.useEffect(()=>{if(x){const{items:l,invoice:u,...L}=x;l?(f(l),w(x)):u.items&&(f(u.items),w({...u.items,...L,...u}))}return()=>{f([]),w(T)}},[x]),o.useEffect(()=>{e!=null&&e.client&&D(e.client[e.client.type])},[e]),t.jsxs(t.Fragment,{children:[t.jsx(F,{onBack:()=>{y(`/${n.toLowerCase()}`)},title:`${I} # ${e.number}/${e.year||""}`,ghost:!1,tags:[t.jsx(v,{color:($=A(e.status))==null?void 0:$.color,children:e.status&&s(e.status)},"status"),e.paymentStatus&&t.jsx(v,{color:(S=A(e.paymentStatus))==null?void 0:S.color,children:e.paymentStatus&&s(e.paymentStatus)},"paymentStatus")],extra:[t.jsx(c,{onClick:()=>{y(`/${n.toLowerCase()}`)},icon:t.jsx(Y,{}),children:s("Close")},`${d.generate()}`),t.jsx(c,{onClick:()=>{window.open(`${W}${n}/${n}-${e._id}.pdf`,"_blank")},icon:t.jsx(z,{}),children:s("Download PDF")},`${d.generate()}`),t.jsx(c,{loading:_,onClick:()=>{R(e._id)},icon:t.jsx(q,{}),children:s("Send by Email")},`${d.generate()}`),t.jsx(c,{onClick:()=>{N(b.convert({entity:n,id:e._id}))},icon:t.jsx(V,{}),style:{display:n==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${d.generate()}`),t.jsx(c,{onClick:()=>{N(b.currentAction({actionType:"update",data:e})),y(`/${n.toLowerCase()}/update/${e._id}`)},type:"primary",icon:t.jsx(H,{}),children:s("Edit")},`${d.generate()}`)],style:{padding:"20px 0px"},children:t.jsxs(j,{children:[t.jsx(p,{title:"Status",value:e.status}),t.jsx(p,{title:s("SubTotal"),value:i({amount:e.subTotal}),style:{margin:"0 32px"}}),t.jsx(p,{title:s("Total"),value:i({amount:e.total}),style:{margin:"0 32px"}}),t.jsx(p,{title:s("Balance"),value:i({amount:e.credit}),style:{margin:"0 32px"}})]})}),t.jsx(g,{dashed:!0}),t.jsxs(h,{title:`Client : ${e.client.name}`,children:[t.jsx(h.Item,{label:s("Address"),children:C.address}),t.jsx(h.Item,{label:s("email"),children:C.email}),t.jsx(h.Item,{label:s("Phone"),children:C.phone})]}),t.jsx(g,{}),t.jsxs(j,{gutter:[12,0],children:[t.jsx(a,{className:"gutter-row",span:11,children:t.jsx("p",{children:t.jsx("strong",{children:s("Product")})})}),t.jsx(a,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:t.jsx("strong",{children:s("Price")})})}),t.jsx(a,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:t.jsx("strong",{children:s("Quantity")})})}),t.jsx(a,{className:"gutter-row",span:5,children:t.jsx("p",{style:{textAlign:"right"},children:t.jsx("strong",{children:s("Total")})})}),t.jsx(g,{})]}),k.map(l=>t.jsx(G,{item:l},l._id)),t.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:t.jsxs(j,{gutter:[12,-5],children:[t.jsx(a,{className:"gutter-row",span:12,children:t.jsxs("p",{children:[s("Sub Total")," :"]})}),t.jsx(a,{className:"gutter-row",span:12,children:t.jsx("p",{children:i({amount:e.subTotal})})}),t.jsx(a,{className:"gutter-row",span:12,children:t.jsxs("p",{children:[s("Tax Total")," (",e.taxRate," %) :"]})}),t.jsx(a,{className:"gutter-row",span:12,children:t.jsx("p",{children:i({amount:e.taxTotal})})}),t.jsx(a,{className:"gutter-row",span:12,children:t.jsxs("p",{children:[s("Total")," :"]})}),t.jsx(a,{className:"gutter-row",span:12,children:t.jsx("p",{children:i({amount:e.total})})})]})})]})}export{mt as R};
