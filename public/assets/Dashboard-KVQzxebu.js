import{a as L,h as P,am as e,aB as M,aA as V,au as B}from"./index-NNRCG9Rm.js";import{A as _,V as b,a3 as W,a4 as H,a5 as K,$ as h,a6 as g,a7 as D,a8 as w,T as Q}from"./IdurarOs-hOF3usfi.js";import{u as R}from"./useDate-Fz8rfIL3.js";import{u as y}from"./useFetch-3iL7NbWa.js";import{t as G}from"./statusTagColor-sG5xH6CK.js";import{e as I}from"./actions-NDaFrLo5.js";import{F as J}from"./FilePdfOutlined-4twY-BbQ.js";import{D as X,E as Y}from"./ErpApp-og-vdlRX.js";import{T as Z}from"./Table-yESaXSHN.js";import{T as q}from"./index-ntKD6FMB.js";import{P as F}from"./progress-r0o2llHg.js";import{S as ee}from"./index-lIOrhGAA.js";import"./currency.es--or6eeOG.js";import"./zh_CN-pm_5gTTN.js";var te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"};const ne=te;var se=function(t,a){return L.createElement(_,P({},t,{ref:a,icon:ne}))};const ae=L.forwardRef(se);var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"};const ie=re;var oe=function(t,a){return L.createElement(_,P({},t,{ref:a,icon:ie}))};const le=L.forwardRef(oe);function $({...n}){const t=b();let{entity:a,dataTableColumns:i}=n;const u=[{label:t("Show"),key:"read",icon:e.jsx(W,{})},{label:t("Edit"),key:"edit",icon:e.jsx(H,{})},{label:t("Download"),key:"download",icon:e.jsx(J,{})}],m=M(),r=V(),p=o=>{r(I.currentItem({data:o})),m(`/${a}/read/${o._id}`)},l=o=>{r(I.currentAction({actionType:"update",data:o})),m(`/${a}/update/${o._id}`)},j=o=>{window.open(`${K}${a}/${a}-${o._id}.pdf`,"_blank")};i=[...i,{title:"",key:"action",render:(o,s)=>e.jsx(X,{menu:{items:u,onClick:({key:d})=>{switch(d){case"read":p(s);break;case"edit":l(s);break;case"download":j(s);break}}},trigger:["click"],children:e.jsx(Y,{style:{cursor:"pointer",fontSize:"24px"},onClick:d=>d.preventDefault()})})}];const c=()=>h.list({entity:a}),{result:A,isLoading:N,isSuccess:v}=y(c),O=()=>v&&A?A.slice(0,5):[];return e.jsx(Z,{columns:i,rowKey:o=>o._id,dataSource:v&&O(),pagination:!1,loading:N,scroll:{x:!0}})}function k({title:n,tagContent:t,tagColor:a,prefix:i,isLoading:u=!1}){const{moneyFormatter:m}=R();return e.jsx(g,{className:"gutter-row",xs:{span:24},sm:{span:12},md:{span:12},lg:{span:6},children:e.jsxs("div",{className:"whiteBox shadow",style:{color:"#595959",fontSize:13,minHeight:"106px",height:"100%"},children:[e.jsx("div",{className:"pad15 strong",style:{textAlign:"center",justifyContent:"center"},children:e.jsx("h3",{style:{color:"#22075e",fontSize:"large",margin:"5px 0",textTransform:"capitalize"},children:n})}),e.jsx(D,{style:{padding:0,margin:0}}),e.jsx("div",{className:"pad15",children:e.jsxs(w,{gutter:[0,0],justify:"space-between",wrap:!1,children:[e.jsx(g,{className:"gutter-row",flex:"85px",style:{textAlign:"left"},children:e.jsx("div",{className:"left",style:{whiteSpace:"nowrap"},children:i})}),e.jsx(D,{style:{height:"100%",padding:"10px 0",justifyContent:"center",alignItems:"center"},type:"vertical"}),e.jsx(g,{className:"gutter-row",flex:"auto",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:u?e.jsx(B,{}):e.jsx(Q,{title:t,children:e.jsx(q,{color:a,style:{margin:"0 auto",justifyContent:"center",maxWidth:"110px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:t||m({amount:0})})})})]})})]})})}const E={draft:"#595959",sent:"#1890ff",pending:"#1890ff",unpaid:"#ffa940",overdue:"#ff4d4f",partially:"#13c2c2",paid:"#95de64",declined:"#ff4d4f",accepted:"#95de64",cyan:"#13c2c2",purple:"#722ed1",expired:"#614700"},z=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"sent",value:0},{tag:"accepted",value:0},{tag:"declined",value:0},{tag:"expired",value:0}],ce=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"overdue",value:0},{tag:"paid",value:0},{tag:"unpaid",value:0},{tag:"partially",value:0}],de=({tag:n,color:t,value:a})=>{const i=b();return e.jsxs("div",{style:{color:"#595959",marginBottom:5},children:[e.jsx("div",{className:"left alignLeft capitalize",children:i(n)}),e.jsxs("div",{className:"right alignRight",children:[a," %"]}),e.jsx(F,{percent:a,showInfo:!1,strokeColor:{"0%":t,"100%":t}})]})};function ue({title:n="Preview",statistics:t=z,isLoading:a=!1,entity:i="invoice"}){const u=L.useMemo(()=>i==="invoice"?ce.map(r=>(Array.isArray(t)?t.find(l=>l.tag===r.tag):null)||r):z.map(r=>(Array.isArray(t)?t.find(l=>l.tag===r.tag):null)||r),[t,i]),m=(r,p)=>{const l=Object.values(E),j=l.indexOf(r.props.color),c=l.indexOf(p.props.color);return j-c};return e.jsx(g,{className:"gutter-row",xs:{span:24},sm:{span:24},md:{span:8},lg:{span:8},children:e.jsxs("div",{className:"pad20",children:[e.jsx("h3",{style:{color:"#22075e",fontSize:"large",marginBottom:40,marginTop:0},children:n}),a?e.jsx("div",{style:{textAlign:"center"},children:e.jsx(B,{})}):u==null?void 0:u.map((r,p)=>e.jsx(de,{tag:r.tag,color:E[r.tag],value:r==null?void 0:r.value},p)).sort(m)]})})}function pe({isLoading:n=!1,activeCustomer:t=0,newCustomer:a=0}){const i=b();return e.jsx(w,{className:"gutter-row",children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsxs("div",{className:"pad20",style:{textAlign:"center",justifyContent:"center"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:40,marginTop:15,fontSize:"large"},children:i("Customer Preview")}),n?e.jsx(B,{}):e.jsxs("div",{style:{display:"grid",justifyContent:"center"},children:[e.jsx(F,{type:"dashboard",percent:a,size:148}),e.jsx("p",{children:i("New Customer this Month")}),e.jsx(D,{}),e.jsx(ee,{title:i("Active Customer"),value:t,precision:2,valueStyle:t>0?{color:"#3f8600"}:t<0?{color:"#cf1322"}:{color:"#000000"},prefix:t>0?e.jsx(le,{}):t<0?e.jsx(ae,{}):null,suffix:"%"})]})]})})})}function me(){const n=b(),{moneyFormatter:t}=R(),{result:a,isLoading:i}=y(()=>h.summary({entity:"invoice"})),{result:u,isLoading:m}=y(()=>h.summary({entity:"quote"})),{result:r,isLoading:p}=y(()=>h.summary({entity:"offer"})),{result:l,isLoading:j}=y(()=>h.summary({entity:"payment"})),{result:c,isLoading:A}=y(()=>h.summary({entity:"client"})),N=[{title:n("number"),dataIndex:"number"},{title:n("Client"),dataIndex:["client","name"]},{title:n("Total"),dataIndex:"total",onCell:()=>({style:{textAlign:"right",whiteSpace:"nowrap"}}),render:s=>t({amount:s})},{title:n("Status"),dataIndex:"status",render:s=>{var d;return e.jsx(q,{color:(d=G(s))==null?void 0:d.color,children:n(s)})}}],v=[{result:a,isLoading:i,entity:"invoice",title:n("Invoices preview")},{result:u,isLoading:m,entity:"quote",title:n("quotes preview")},{result:r,isLoading:p,entity:"offer",title:n("offers preview")},{result:l,isLoading:j,entity:"payment",title:n("payments preview")}],O=v.map((s,d)=>{const{result:x,entity:S,isLoading:C}=s;return S==="offer"?null:e.jsx(k,{title:(s==null?void 0:s.entity)==="payment"?n("Payment"):n(s==null?void 0:s.entity),tagColor:(s==null?void 0:s.entity)==="invoice"?"cyan":(s==null?void 0:s.entity)==="quote"?"purple":"green",prefix:n("This month"),isLoading:C,tagContent:t({amount:x==null?void 0:x.total})},d)}),o=v.map((s,d)=>{var T;const{result:x,entity:S,isLoading:C,title:U}=s;return S==="payment"?null:e.jsx(ue,{title:U,isLoading:C,entity:S,statistics:!C&&((T=x==null?void 0:x.performance)==null?void 0:T.map(f=>({tag:f==null?void 0:f.status,color:"blue",value:f==null?void 0:f.percentage})))},d)});return e.jsxs(e.Fragment,{children:[e.jsxs(w,{gutter:[32,32],children:[O,e.jsx(k,{title:n("Due Balance"),tagColor:"red",prefix:n("Not Paid"),isLoading:i,tagContent:t({amount:a==null?void 0:a.total_undue})})]}),e.jsx("div",{className:"space30"}),e.jsxs(w,{gutter:[32,32],children:[e.jsx(g,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:18},children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsx(w,{className:"pad20",gutter:[0,0],children:o})})}),e.jsx(g,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:6},children:e.jsx(pe,{isLoading:A,activeCustomer:c==null?void 0:c.active,newCustomer:c==null?void 0:c.new})})]}),e.jsx("div",{className:"space30"}),e.jsxs(w,{gutter:[32,32],children:[e.jsx(g,{className:"gutter-row w-full",sm:{span:24},lg:{span:12},children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{height:"100%"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:5,padding:"0 20px 20px"},children:n("Recent Invoices")}),e.jsx($,{entity:"invoice",dataTableColumns:N})]})}),e.jsx(g,{className:"gutter-row w-full",sm:{span:24},lg:{span:12},children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{height:"100%"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:5,padding:"0 20px 20px"},children:n("Recent Quotes")}),e.jsx($,{entity:"quote",dataTableColumns:N})]})})]})]})}function Oe(){return e.jsx(me,{})}export{Oe as default};
